---
import Application from "@/layouts/Application.astro"

import Label from "@/components/Label.astro"
import Select from "@/components/Select.astro"

import { DATA } from "@/pages/index/components/Faq/data"

const faq = DATA.at(0)!.items
---

<Application>
  <main>
    <div class="md:bg-white md:bg-opacity-60 pb-8 pt-6 md:py-12 md:px-4">
      <div class="max-w-content w-full mx-auto">
        <div class="max-w-[52.5rem] flex flex-col">
          <h1 class="font-bold text-[1.5rem] leading-9 px-4 md:px-4">
            Contact us
          </h1>

          <div
            class="mt-6 md:mt-8 bg-white md:rounded-[1rem] max-w-[44.375rem] p-6 md:p-8"
          >
            <form>
              <ul
                class="font-semibold text-[0.75rem] leading-[0.875rem] flex flex-col gap-5"
              >
                <li class="flex flex-col gap-3">
                  <Label
                    id="contacts-email"
                    title="Email"
                  >
                    <input
                      type="email"
                      class="border border-mid-gray rounded-[0.5rem] h-[2.25rem] px-4"
                      id="contacts-email"
                    />
                  </Label>
                </li>

                <li class="flex flex-col gap-3">
                  <Label
                    id="contacts-name"
                    title="Full name"
                  >
                    <input
                      type="text"
                      class="border border-mid-gray rounded-[0.5rem] h-[2.25rem] px-4"
                      id="contacts-name"
                    />
                  </Label>
                </li>

                <li class="flex flex-col gap-3">
                  <Label
                    id="contacts-category"
                    title="Category"
                  >
                    <Select
                      id="contacts-category"
                      options={["Option 1", "Option 2", "Option 3"]}
                    />
                  </Label>
                </li>

                <li class="flex flex-col gap-3">
                  <Label
                    id="contacts-subcategory"
                    title="Subcategory"
                  >
                    <Select
                      id="contacts-subcategory"
                      options={["Option 1", "Option 2", "Option 3"]}
                    />
                  </Label>
                </li>

                <div>
                  <div class="uppercase text-mid-gray">Faq</div>

                  <ul
                    id="faq"
                    class="mt-5 flex flex-col gap-6"
                  >
                    {
                      faq.map(({ title, content }) => (
                        <li>
                          <button
                            type="button"
                            class="font-bold data-[active='true']:text-blue text-mid-gray md:hover:text-blue text-[1.125rem] leading-[1.625rem] text-left"
                          >
                            {title}
                          </button>

                          <div
                            class="text overflow-clip transition-all"
                            style={{ height: 0, opacity: 0 }}
                          >
                            <div
                              class="pt-4 text-[0.875rem] font-normal leading-6"
                              set:html={content}
                            />
                          </div>
                        </li>
                      ))
                    }

                    <li>
                      <button
                        type="button"
                        class="font-bold data-[active='true']:text-blue text-mid-gray hover:text-blue text-[1.125rem] leading-[1.625rem] text-left"
                      >
                        Other question
                      </button>

                      <div
                        class="text overflow-clip transition-all"
                        style={{ height: 0, opacity: 0 }}
                      >
                        <div class="pt-4 flex flex-col gap-3">
                          <Label
                            id="contacts-question"
                            title="Your question"
                          >
                            <textarea
                              class="border resize-none border-mid-gray rounded-[0.5rem] p-4"
                              rows="4"
                              id="contacts-question"
                            ></textarea>
                          </Label>
                        </div>
                      </div>
                    </li>
                  </ul>
                </div>
              </ul>

              <div class="mt-8 flex flex-col gap-2">
                <div
                  class="uppercase text-mid-gray text-[0.75rem] font-semibold"
                >
                  captcha
                </div>

                <div class="flex flex-col md:flex-row md:justify-between">
                  <div></div>

                  <div>
                    <button
                      type="submit"
                      class="border w-full md:w-auto disabled:opacity-60 enabled:hover:text-white enabled:hover:bg-pink transition-colors rounded-full text-pink h-[2.25rem] border-pink flex justify-center items-center uppercase text-[0.75rem] font-semibold px-8"
                      >Send</button
                    >
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </main>
</Application>

<script is:inline>
  ;(function () {
    const faq = document.getElementById("faq")
    const items = faq?.querySelectorAll(":scope > li")

    items?.forEach((item, item_idx) => {
      const button = item.querySelector("button")

      button?.addEventListener("click", () => {
        items?.forEach((item, idx) => {
          const button = item.querySelector("button")
          const wrapper = item.querySelector(".text")
          const text = wrapper?.querySelector("div")
          if (!wrapper || !text) return

          const active = button.dataset.active === "true"

          if (item_idx === idx && !active) {
            button.dataset.active = "true"
            wrapper.style.height = text.clientHeight + "px"
            wrapper.style.opacity = "1"
          } else {
            delete button.dataset.active
            wrapper.style.height = "0"
            wrapper.style.opacity = "0"
          }
        })
      })
    })
  })()
</script>
